<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="FoodVerse">
    <meta name="author" content="Santiago Botero">
    <title>Busqueda del tesoro</title>
    <meta name="description" content="demo: aframe-maze-component" />
    <script src="https://aframe.io/releases/0.7.1/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.0.0/dist/aframe-environment-component.min.js"></script>
    <script src="//cdn.rawgit.com/donmccurdy/aframe-extras/v3.13.1/dist/aframe-extras.min.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@0.6.0/dist/aframe-look-at-component.min.js"></script>
    <script src="https://unpkg.com/aframe-maze-component@0.1.24/dist/aframe-maze-component.min.js"></script>
    <script src="../js/info-message.js"></script>
    <script src="../js/highlight.js"></script>
    <script src="../js/info-panel.js"></script>

    <script>
      AFRAME.registerComponent("cofre", {
        init: function () {
          var el = this.el; 
          var ex = this; 
          console.log(this)

          el.addEventListener("click", function () {
            el.setAttribute("position", { x: 1, y: 4, z: 1 });
            el.setAttribute("color", "#fff");
          });
        },
      });
    </script>
  </head>
  <body>
    <a-scene
      physics="debug: true"
      camera-position
      environment="preset: yavapai; ground:flat;  groundTexture: walkernoise; "
      cursor="rayOrigin: mouse; fuse: false"
      raycaster="far: 100; objects: .raycastable"
      info-message="htmlSrc: #instrucciones">
      <a-assets>
        <a-asset-item id="instrucciones" src="message.html"></a-asset-item>
        <img id="textura-pared-laberinto" src="assets/muro.jpg" />
        <img id="cofre" src="assets/cofre.png" />
        <a-box
          id="pared-laberinto"
          static-body
          material="src: #textura-pared-laberinto"
          depth="1"
          width="4"
          height="4">
        </a-box>
        <!-- <a-asset-item id="faro" src="assets/faro.glb"></a-asset-item> -->
        <img id="kazetachinu" src="https://cdn.aframe.io/examples/ui/kazetachinu.jpg" crossorigin="anonymous"/>
        <img id="kazetachinuPoster" src="https://cdn.aframe.io/examples/ui/kazetachinuPoster.jpg" crossorigin="anonymous"/>
        
        <a-mixin
          id="frame"
          geometry="primitive: plane; width: 0.5783552; height: 0.8192"
          material="color: white; shader: flat"
          animation__scale="property: scale; to: 1.2 1.2 1.2; dur: 200; startEvents: mouseenter"
          animation__scale_reverse="property: scale; to: 1 1 1; dur: 200; startEvents: mouseleave"
         ></a-mixin>
         <a-mixin
          id="poster"
          geometry="primitive: plane; width: 0.544768; height: 0.786432"
          material="color: white; shader: flat"
          material="shader: flat"
          position="0 0 0.005"
         ></a-mixin>
         <a-mixin
          id="cuponImage"
          geometry="primitive: plane; width: 1.5; height: 0.81"
          material=" shader: flat; transparent: true"
          position="0 0.495 0.002"
         ></a-mixin>
      </a-assets>

      <a-box
        id="cofre"
        position="1 1 0"
        static-body
        material="src: #cofre"
        cofre>
      </a-box>
      
      <a-entity
        id="laberinto"
        maze="size: 5 5 5; wall: #pared-laberinto;  open: S 9 3 N 2 6;"
        position="0 0 0"
        rotation="0 0 0"
      ></a-entity>

      <a-entity id="explorador"
        camera
        universal-controls
        position="-20 10.8 20"
        jump-ability
        kinematic-body>
        <a-cursor></a-cursor>
      </a-entity>

      <a-plane id="piso-falso"
        static-body
        rotation="-90 0 0"
        position="0 -0.1 0"
        width="200"
        height="200"
      ></a-plane>
<!--cupon selector-->
      <a-entity
        id="background"
        position="0 0 0"
        geometry="primitive: sphere; radius: 2.0"
        material="color: red; side: back; shader: flat"
        scale="0.001 0.001 0.001"
        visible="false" class="raycastable">
      </a-entity>
      
      <a-entity position="2 2 0">
        <a-entity
          id="fadeBackground"
          geometry="primitive: sphere; radius: 2.5"
          material="color: black; side: back; shader: flat; transparent: true; opacity: 0.6" visible="false">
        </a-entity>
      </a-entity>


      <a-entity id="ui" position="0 1.6 -2.5">
        <!-- Poster menu -->
        <a-entity id="menu" highlight>
          <a-entity id="kazetachinuButton" position="0 0 0" mixin="frame" class="raycastable menu-button">
            <a-entity material="src: #kazetachinuPoster" mixin="poster"></a-entity>
          </a-entity>

        </a-entity>

        <!-- Info panel of the selected cupon. -->
        <a-entity
          id="infoPanel"
          position="0 0 0.5"
          info-panel
          visible="false"
          scale="0.001 0.001 0.001"
          geometry="primitive: plane; width: 1.5; height: 1.8"
          material="color: #333333; shader: flat; transparent: false" class="raycastable">

          <a-entity id="kazetachinucuponImage" mixin="cuponImage" material="src: #kazetachinu" visible="false"></a-entity>

          <a-entity id="cuponTitle"
            position="-0.68 -0.1 0"
            text="shader: msdf; anchor: left; width: 1.5; font: https://cdn.aframe.io/examples/ui/Viga-Regular.json; color: white; value: Ponyo (2003)"></a-entity>
          <a-entity id="cuponDescription"
            position="-0.68 -0.2 0"
            text="baseline: top; shader: msdf; anchor: left; font: https://cdn.aframe.io/examples/ui/Viga-Regular.json; color: white; value: hello"></a-entity>
        </a-entity>
      </a-entity>
    </a-scene>
  </body>
</html>
